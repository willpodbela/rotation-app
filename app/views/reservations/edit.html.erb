<%= link_to("<< All Reservations", reservations_path, :class => 'back-link') %></br>
<%= link_to("<< All Reservations for Item", item_reservations_path(@reservation.item_id), :class => 'back-link') %>

<div class="reservations edit">
  <h2>Edit Reservation</h2>

  <%= form_for(@reservation) do |f| %>

    <table summary="Reservation form fields">
      <tr>
        <th>User ID</th>
        <td><%= @reservation.user.id %></td>
      </tr>
      <tr>
        <th>User Email</th>
        <td><%= @reservation.user.email %></td>
      </tr>
      <tr>
        <th>Size</th>
        <td><%= f.collection_select :size, Reservation.sizes.map{ |a| [a.first,a.first] },  :first, :second, include_blank: true %></td>
      </tr>
      <tr>
        <th>Start Date</th>
        <td><%= f.date_select :start_date, include_blank: true %></td>
      </tr>
      <tr>
        <th>End Date</th>
        <td><%= f.date_select :end_date, include_blank: true %></td>
      </tr>
      <tr>
        <th>Status</th>
        <td><%=  f.collection_select :status, Reservation.statuses.map{ |a| [a.first,a.first] },  :first, :second, include_blank: true %></td>
      </tr>
      <tr>
        <th>Assigned Inventory</th>
        <td>
          <% if @reservation.size.nil? %>
            <span style="color: red">Set size to see available inventory</span>
          <% else %>
            <% owned_inventory = @reservation.units_available_for_fulfillment %>
            <% if owned_inventory.empty? %>
              <span style="color: orange">No available inventory.</span>
            <% else %>
              <%= f.collection_select :unit_id, owned_inventory.map{ |a| [a.id, "#{a.id}: #{a.size} - #{a.item.title or ''} #{a.item.subtitle or ''}"] },  :first, :second, include_blank: true %></td>
            <% end %>
          <% end %>
      </tr>     
    </table>

    <div class="form-buttons">
      <%= f.submit("Update Item") %>
    </div>

  <% end %>
</div>